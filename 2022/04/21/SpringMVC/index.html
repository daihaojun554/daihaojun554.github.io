<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SpringMVC"><meta name="keywords" content="SpringMVC,Spring"><meta name="author" content="DaiHaojun"><meta name="copyright" content="DaiHaojun"><title>SpringMVC | myblog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.1.0'
} </script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="myblog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Spring-MVC"><span class="toc-number">1.</span> <span class="toc-text">一、Spring-MVC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1%E3%80%81SpringMVC%E7%9A%84%E6%A0%B8%E5%BF%83"><span class="toc-number">1.1.</span> <span class="toc-text">1.1、SpringMVC的核心</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81SpringMVC%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">二、SpringMVC的概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1SpringMVC%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">2.1.</span> <span class="toc-text">2.1SpringMVC的优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E3%80%81SpringMVC%E7%9A%84%E6%9C%AC%E8%B4%A8%E5%B7%A5%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">2.2、SpringMVC的本质工作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81SpringMVC%E7%9A%84%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2"><span class="toc-number">3.</span> <span class="toc-text">三、SpringMVC的框架部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1%E3%80%81%E5%9F%BA%E4%BA%8Emaven%E5%88%9B%E5%BB%BAweb%E5%B7%A5%E7%A8%8B"><span class="toc-number">3.1.</span> <span class="toc-text">3.1、基于maven创建web工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%E3%80%81%E6%B7%BB%E5%8A%A0spring%E2%80%94MVC%E7%9A%84%E4%BE%9D%E8%B5%96"><span class="toc-number">3.2.</span> <span class="toc-text">3.2、添加spring—MVC的依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3%E3%80%81%E5%88%9B%E5%BB%BASpringMVC%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">3.3、创建SpringMVC的配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4%E3%80%81%E5%9C%A8web-xml%E4%B8%AD%E9%85%8D%E7%BD%AESpringMVC%E7%9A%84%E5%89%8D%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">3.4.</span> <span class="toc-text">3.4、在web.xml中配置SpringMVC的前端控制器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81SpringMVC%E7%9A%84%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">四、SpringMVC的框架使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E5%88%9B%E5%BB%BA%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">4.1创建控制器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E3%80%81%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%AD%E5%A3%B0%E6%98%8E%E8%AF%B7%E6%B1%82%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">4.2.</span> <span class="toc-text">4.2、在控制器中声明请求的方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3%E3%80%81%E5%88%9B%E5%BB%BA%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E8%A1%A8%E5%8D%95"><span class="toc-number">4.3.</span> <span class="toc-text">4.3、创建前端页面表单</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1%E3%80%81-x2F-%E5%92%8C-x2F-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.3.1、&#x2F;* 和&#x2F;的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4%E3%80%81%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">4.4.</span> <span class="toc-text">4.4、静态资源的配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5%E3%80%81%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%8F%90%E4%BA%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">4.5.</span> <span class="toc-text">4.5、前端页面提交数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-1%E3%80%81%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1、表单提交:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">4.5.2.</span> <span class="toc-text">添加图书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-2%E3%80%81URL%E6%8F%90%E4%BA%A4"><span class="toc-number">4.5.3.</span> <span class="toc-text">4.5.2、URL提交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-3%E3%80%81AJAX%E6%8F%90%E4%BA%A4%EF%BC%9A"><span class="toc-number">4.5.4.</span> <span class="toc-text">4.5.3、AJAX提交：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6%E3%80%81%E5%90%8E%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%99%A8%E6%8E%A5%E6%94%B6%E5%89%8D%E7%AB%AF%E6%8F%90%E4%BA%A4%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">4.6.</span> <span class="toc-text">4.6、后端控制器接收前端提交的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-1%E3%80%81%E8%AF%B7%E6%B1%82%E8%A1%8C%E4%BC%A0%E5%80%BC%E7%9A%84%E6%8E%A5%E6%94%B6%E6%96%B9%E5%BC%8F"><span class="toc-number">4.6.1.</span> <span class="toc-text">4.6.1、请求行传值的接收方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-2-%E4%B8%A4%E7%A7%8D%E4%BC%A0%E5%80%BC%E6%96%B9%E5%BC%8F%E5%8F%AF%E4%BB%A5%E6%B7%B7%E5%9C%A8%E4%B8%80%E8%B5%B7%E7%94%A8"><span class="toc-number">4.6.2.</span> <span class="toc-text">4.6.2 两种传值方式可以混在一起用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-3%E3%80%81%E8%AF%B7%E6%B1%82%E4%BD%93%E7%9A%84%E4%BC%A0%E5%80%BC%E6%8E%A5%E6%94%B6"><span class="toc-number">4.6.3.</span> <span class="toc-text">4.6.3、请求体的传值接收</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7%E3%80%81%E6%8E%A7%E5%88%B6%E5%99%A8%E5%93%8D%E5%BA%94%E5%89%8D%E7%AB%AF%E8%AF%B7%E6%B1%82"><span class="toc-number">4.7.</span> <span class="toc-text">4.7、控制器响应前端请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-1%E3%80%81%E5%A4%84%E7%90%86%E5%90%8C%E6%AD%A5%E8%AF%B7%E6%B1%82%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">4.7.1.</span> <span class="toc-text">4.7.1、处理同步请求的方法:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-2%E3%80%81%E5%A4%84%E7%90%86%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">4.7.2.</span> <span class="toc-text">4.7.2、处理异步请求的方法:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-3%E3%80%81%E6%8E%A7%E5%88%B6%E5%99%A8%E5%93%8D%E5%BA%94%E5%90%8C%E6%AD%A5%E8%AF%B7%E6%B1%82%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92"><span class="toc-number">4.7.3.</span> <span class="toc-text">4.7.3、控制器响应同步请求的数据传递:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8%E3%80%81%E8%A7%A3%E5%86%B3%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-number">4.8.</span> <span class="toc-text">4.8、解决中文乱码问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-1%E3%80%81%E5%89%8D%E7%AB%AF%E7%BC%96%E7%A0%81%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-number">4.8.1.</span> <span class="toc-text">4.8.1、前端编码的设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-2%E3%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-number">4.8.2.</span> <span class="toc-text">4.8.2、服务器编码问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-3%E3%80%81%E8%AE%BE%E7%BD%AESpringMVC%E7%9A%84%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F%E3%80%81"><span class="toc-number">4.8.3.</span> <span class="toc-text">4.8.3、设置SpringMVC的编码方式、</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81SpringMVC%E7%9A%84%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B"><span class="toc-number">5.</span> <span class="toc-text">四、SpringMVC的请求处理流程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E3%80%81%E8%AF%B7%E6%B1%82%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">5.1.</span> <span class="toc-text">4.1、请求的流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E3%80%81SpringMVC%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="toc-number">5.2.</span> <span class="toc-text">4.2、SpringMVC的核心组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3%E3%80%81%E5%A4%84%E7%90%86%E5%99%A8%E6%98%A0%E5%B0%84%E5%99%A8"><span class="toc-number">5.3.</span> <span class="toc-text">4.3、处理器映射器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4%E3%80%81%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-number">5.4.</span> <span class="toc-text">4.4、视图解析器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">五、日期格式处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1%E3%80%81%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E6%97%A5%E6%9C%9F%E8%BD%AC%E6%8D%A2%E5%99%A8"><span class="toc-number">6.1.</span> <span class="toc-text">5.1、创建自定义的日期转换器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-1%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%BD%AC%E6%8D%A2%E7%B1%BB"><span class="toc-number">6.1.1.</span> <span class="toc-text">5.1.1创建自定义的转换类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-2%E5%B0%86%E8%BF%99%E4%B8%AA%E5%86%99%E8%BD%AC%E6%8D%A2%E5%99%A8%E9%85%8D%E7%BD%AE%E7%BB%99springmvc"><span class="toc-number">6.1.2.</span> <span class="toc-text">5.1.2将这个写转换器配置给springmvc</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">7.</span> <span class="toc-text">六、文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1%E3%80%81SpringMVC%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2"><span class="toc-number">7.1.</span> <span class="toc-text">6.1、SpringMVC的项目部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2%E3%80%81%E6%B7%BB%E5%8A%A0%E5%9B%BE%E4%B9%A6%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%88%E5%9B%BE%E4%B9%A6%E7%9A%84%E5%B0%81%E9%9D%A2%EF%BC%89"><span class="toc-number">7.2.</span> <span class="toc-text">6.2、添加图书上传文件（图书的封面）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">7.3.</span> <span class="toc-text">6.3、文件下载</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">七、统一异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1%E3%80%81Http%E5%BC%82%E5%B8%B8%E7%8A%B6%E6%80%81%E7%9A%84%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86"><span class="toc-number">8.1.</span> <span class="toc-text">7.1、Http异常状态的统一处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-1%E3%80%81java%E4%BB%A3%E7%A0%81%E5%BC%82%E5%B8%B8%E7%9A%84%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86"><span class="toc-number">8.2.</span> <span class="toc-text">7.2.1、java代码异常的统一处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-2%E3%80%81SpringMvc-%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8-%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">8.3.</span> <span class="toc-text">7.2.2、SpringMvc 处理异常 的方式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">9.</span> <span class="toc-text">八、拦截器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1%E3%80%81%E6%8B%A6%E6%88%AA%E5%99%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">9.1.</span> <span class="toc-text">8.1、拦截器介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">9.2.</span> <span class="toc-text">8.2、自定义拦截器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E6%8B%A6%E6%88%AA%E5%99%A8%E9%93%BE"><span class="toc-number">9.3.</span> <span class="toc-text">8.3 拦截器链</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81SpringMVC%E6%95%B4%E5%90%88Spring%E5%92%8CMybatis"><span class="toc-number">10.</span> <span class="toc-text">九、SpringMVC整合Spring和Mybatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1"><span class="toc-number">10.1.</span> <span class="toc-text">9.1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2%E3%80%81%E9%83%A8%E7%BD%B2MyBatis"><span class="toc-number">10.2.</span> <span class="toc-text">9.2、部署MyBatis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3%E3%80%81%E9%83%A8%E7%BD%B2Spring%E5%92%8CSpringMvc"><span class="toc-number">10.3.</span> <span class="toc-text">9.3、部署Spring和SpringMvc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-1%E3%80%81%E5%88%9B%E5%BB%BAspring%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">10.3.1.</span> <span class="toc-text">9.3.1、创建spring配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-2%E3%80%81%E9%85%8D%E7%BD%AE%E5%89%8D%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">10.3.2.</span> <span class="toc-text">9.3.2、配置前端控制器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4%E3%80%81%E6%95%B4%E5%90%88ssm"><span class="toc-number">10.4.</span> <span class="toc-text">9.4、整合ssm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-1%E3%80%81%E5%AF%BC%E5%85%A5mybatis-spring%E7%9A%84%E4%BE%9D%E8%B5%96"><span class="toc-number">10.4.1.</span> <span class="toc-text">9.4.1、导入mybatis-spring的依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-2%E3%80%81%E9%85%8D%E7%BD%AE%E7%9A%84druid%E7%9A%84%E4%BE%9D%E8%B5%96"><span class="toc-number">10.4.2.</span> <span class="toc-text">9.4.2、配置的druid的依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-3%E3%80%81%E5%88%9B%E5%BB%BAdruid%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">10.4.3.</span> <span class="toc-text">9.4.3、创建druid的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-4%E3%80%81%E5%88%9B%E5%BB%BASqlSessionFactory"><span class="toc-number">10.4.4.</span> <span class="toc-text">9.4.4、创建SqlSessionFactory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-4%E3%80%81%E9%85%8D%E7%BD%AEMapperScannerConfigurer"><span class="toc-number">10.4.5.</span> <span class="toc-text">9.4.4、配置MapperScannerConfigurer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5%E3%80%81%E6%95%B4%E5%90%88%E9%85%8D%E7%BD%AEAOP"><span class="toc-number">10.5.</span> <span class="toc-text">9.5、整合配置AOP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">11.</span> <span class="toc-text">十、测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1%E3%80%81%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB%EF%BC%9A"><span class="toc-number">11.1.</span> <span class="toc-text">10.1、创建实体类：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2%E3%80%81%E5%9C%A8dao%E4%B8%AD%E5%88%9B%E5%BB%BA%E6%8E%A5%E5%8F%A3"><span class="toc-number">11.2.</span> <span class="toc-text">10.2、在dao中创建接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3%E3%80%81%E5%9C%A8mappers%E5%8C%85%E4%B8%8B%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">11.3.</span> <span class="toc-text">10.3、在mappers包下创建映射文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-4%E3%80%81%E4%BD%BF%E7%94%A8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%B5%8B%E8%AF%95Dao"><span class="toc-number">11.4.</span> <span class="toc-text">10.4、使用单元测试测试Dao</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81MybatisGenerator"><span class="toc-number">12.</span> <span class="toc-text">十一、MybatisGenerator</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1%E3%80%81%E5%88%9B%E5%BB%BAgeneratorConfig-xml%E6%96%87%E4%BB%B6"><span class="toc-number">12.1.</span> <span class="toc-text">11.1、创建generatorConfig.xml文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2%E3%80%81%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8%E7%B1%BB"><span class="toc-number">12.2.</span> <span class="toc-text">11.2、创建启动类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3%E3%80%81%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%89%B9%E9%87%8F%E7%9A%84%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE"><span class="toc-number">12.3.</span> <span class="toc-text">11.3、创建一个批量的测试数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-4%E3%80%81"><span class="toc-number">12.4.</span> <span class="toc-text">11.4、</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">DaiHaojun</div><div class="author-info__description text-center">记录学习日常</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">25</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">36</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">myblog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">SpringMVC</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-04-20</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="一、Spring-MVC"><a href="#一、Spring-MVC" class="headerlink" title="一、Spring-MVC"></a>一、Spring-MVC</h1><p><img src="/2022/04/21/SpringMVC/image-20220409222429570.png" alt="image-20220409222429570"></p>
<h2 id="1-1、SpringMVC的核心"><a href="#1-1、SpringMVC的核心" class="headerlink" title="1.1、SpringMVC的核心"></a>1.1、SpringMVC的核心</h2><ul>
<li><p>SpirngMVC的请求处理流程</p>
</li>
<li><p>SpringMVC的核心组件</p>
</li>
<li><p>处理器映射器</p>
</li>
<li><p>视图解析器</p>
</li>
<li><p>拦截器的原理和自定义拦截器</p>
</li>
<li><p>自定义的日期转换器</p>
</li>
<li><p>文件上传及案例</p>
</li>
<li><p>文件下载及案例</p>
</li>
<li><p>统一异常处理</p>
</li>
<li><p>SSM的整合</p>
</li>
</ul>
<h1 id="二、SpringMVC的概述"><a href="#二、SpringMVC的概述" class="headerlink" title="二、SpringMVC的概述"></a>二、SpringMVC的概述</h1><table>
<thead>
<tr>
<th>SpringMVC是用Spring官方提供的基于MVC理念的web框架</th>
</tr>
</thead>
<tbody><tr>
<td>springMVC基于servlet封装的用于实现MVC的控制框架，实现前端和服务端的交互</td>
</tr>
</tbody></table>
<h2 id="2-1SpringMVC的优势"><a href="#2-1SpringMVC的优势" class="headerlink" title="2.1SpringMVC的优势"></a>2.1SpringMVC的优势</h2><ul>
<li>严格遵守了MVC的分层</li>
<li>采用了低耦合，插件式的结构</li>
<li>SpringMVC是基于Spring的扩展，提供了一套完善的注解</li>
<li>SpringMVC在进行数据绑定和视图解析的时候，都提供了多种处理方式，可灵活配置</li>
<li>SpringMVC对RESful Url设计方法提供了良好的支持</li>
</ul>
<h2 id="2-2、SpringMVC的本质工作"><a href="#2-2、SpringMVC的本质工作" class="headerlink" title="2.2、SpringMVC的本质工作"></a>2.2、SpringMVC的本质工作</h2><ul>
<li>接受并且解析请求</li>
<li>处理请求</li>
<li>数据渲染，响应请求</li>
</ul>
<h1 id="三、SpringMVC的框架部署"><a href="#三、SpringMVC的框架部署" class="headerlink" title="三、SpringMVC的框架部署"></a>三、SpringMVC的框架部署</h1><h2 id="3-1、基于maven创建web工程"><a href="#3-1、基于maven创建web工程" class="headerlink" title="3.1、基于maven创建web工程"></a>3.1、基于maven创建web工程</h2><ul>
<li>jsp 和 servlet</li>
</ul>
<p><img src="/2022/04/21/SpringMVC/image-20220409232843683.png" alt="image-20220409232843683"></p>
<ul>
<li><p>项目结构的 配置</p>
</li>
<li><p><img src="/2022/04/21/SpringMVC/image-20220409232927447.png" alt="image-20220409232927447"></p>
</li>
<li><p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee </span></span></span><br><span class="line"><span class="string"><span class="tag">        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span> </span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-2、添加spring—MVC的依赖"><a href="#3-2、添加spring—MVC的依赖" class="headerlink" title="3.2、添加spring—MVC的依赖"></a>3.2、添加spring—MVC的依赖</h2><ul>
<li>spring-context </li>
<li>spring-aspects </li>
<li>spring-jdbc   整合mybatis</li>
<li>spring-web</li>
<li>spring-webmvc</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring-version</span>&gt;</span>5.3.18<span class="tag">&lt;/<span class="name">spring-version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-3、创建SpringMVC的配置文件"><a href="#3-3、创建SpringMVC的配置文件" class="headerlink" title="3.3、创建SpringMVC的配置文件"></a>3.3、创建SpringMVC的配置文件</h2><ul>
<li>在resource的文件夹下Spring-Servlet.xml</li>
<li>添加MVC的命名空间</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- more bean definitions go here --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dhj&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    使用注解配置的aop代理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--声明mvc使用注解驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-4、在web-xml中配置SpringMVC的前端控制器"><a href="#3-4、在web-xml中配置SpringMVC的前端控制器" class="headerlink" title="3.4、在web.xml中配置SpringMVC的前端控制器"></a>3.4、在web.xml中配置SpringMVC的前端控制器</h2><p><strong>SpringMVC中提供了一个DispatcherServlet的类（SpringMVC的中央处理器），用于拦截用户请求交由SprintgMVC的处理</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="四、SpringMVC的框架使用"><a href="#四、SpringMVC的框架使用" class="headerlink" title="四、SpringMVC的框架使用"></a>四、SpringMVC的框架使用</h1><table>
<thead>
<tr>
<th>在SpringMVC中，我们把用户接收请求，处理用户请求的类称为controller</th>
</tr>
</thead>
</table>
<h2 id="4-1创建控制器"><a href="#4-1创建控制器" class="headerlink" title="4.1创建控制器"></a>4.1创建控制器</h2><ul>
<li>创建一个名为com.dhj .controllers的包（包需要在spring注解扫描的范围内)</li>
<li>创建一个类 无需 继承 实现</li>
<li>在类上添加**@Controller** 注解声明此类为SprinMVC的控制器</li>
<li>再次添加**@RequestingMapping(“url”)**注解 声明请求的路径</li>
<li><img src="/2022/04/21/SpringMVC/image-20220409235654490.png" alt="image-20220409235654490"></li>
</ul>
<h2 id="4-2、在控制器中声明请求的方法"><a href="#4-2、在控制器中声明请求的方法" class="headerlink" title="4.2、在控制器中声明请求的方法"></a>4.2、在控制器中声明请求的方法</h2><ul>
<li><p>在一个控制器中可以声明多个方法来处理请求</p>
</li>
<li><p>在每个方法也要加**@RequestingMapping(“url”)**注解，用于声明当前方法的url</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/SpringMVC_demo/">http://localhost:8080/SpringMVC_demo/</a></p>
</li>
</ul>
<p><img src="/2022/04/21/SpringMVC/image-20220410000430840.png" alt="image-20220410000430840"></p>
<h2 id="4-3、创建前端页面表单"><a href="#4-3、创建前端页面表单" class="headerlink" title="4.3、创建前端页面表单"></a>4.3、创建前端页面表单</h2><h3 id="4-3-1、-x2F-和-x2F-的区别"><a href="#4-3-1、-x2F-和-x2F-的区别" class="headerlink" title="4.3.1、&#x2F;* 和&#x2F;的区别"></a>4.3.1、&#x2F;* 和&#x2F;的区别</h3><ul>
<li><p>“&#x2F;*” 表示拦截所有的http请求包括jsp请求，都作为控制器请求的路径来处理在web.xml中去掉  “星号”</p>
</li>
<li><p>“&#x2F;“表示拦截所有的http请求，但是不包括jsp请求，但是不会放行静态资源请求(html,css,js,图片)<br><a target="_blank" rel="noopener" href="http://localhost:8080/SpringMVC_demo/book_add.jsp">http://localhost:8080/SpringMVC_demo/book_add.jsp</a></p>
</li>
</ul>
<p><img src="/2022/04/21/SpringMVC/image-20220410115737853.png" alt="image-20220410115737853"></p>
<h2 id="4-4、静态资源的配置"><a href="#4-4、静态资源的配置" class="headerlink" title="4.4、静态资源的配置"></a>4.4、静态资源的配置</h2><p>静态资源：html,css,js,图片，字体</p>
<p>在spring-servlet.xml中加入这句话表示放行css目录下的资源</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--    静态资源访问的配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/css/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/css/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="http://localhost:8080/SpringMVC_demo/pages/index.html">http://localhost:8080/SpringMVC_demo/pages/index.html</a></p>
<p><img src="/2022/04/21/SpringMVC/image-20220410120751141.png" alt="image-20220410120751141"></p>
<p>这样配置但是访问不了html文件再次到配置文件中加上这么一句话</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/pages/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/pages/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样就可以访问html文件了</p>
<p><img src="/2022/04/21/SpringMVC/image-20220410121000709.png" alt="image-20220410121000709"></p>
<p>最后的静态资源的放行配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--    静态资源访问的配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/css/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/css/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/pages/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/pages/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/imgs/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/imgs/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/js/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/js/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/21/SpringMVC/image-20220410121505301.png" alt="image-20220410121505301"></p>
<h2 id="4-5、前端页面提交数据"><a href="#4-5、前端页面提交数据" class="headerlink" title="4.5、前端页面提交数据"></a>4.5、前端页面提交数据</h2><h3 id="4-5-1、表单提交"><a href="#4-5-1、表单提交" class="headerlink" title="4.5.1、表单提交:"></a>4.5.1、表单提交:</h3><p>form里面需要提供name属性，SpringMVC控制器是通过name取值的</p>
<h3>添加图书</h3>
<form action="//book/add">
    <p>图书名字：<input type="text" name="name"></p>
    <p>图书作者：<input type="text" name="author"></p>
    <p>图书价格：<input type="text" name="price"></p>
    <p><input type="submit" value="提交"></p>
</form>


<h3 id="4-5-2、URL提交"><a href="#4-5-2、URL提交" class="headerlink" title="4.5.2、URL提交"></a>4.5.2、URL提交</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&quot;/book/add?bookName=Java&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-5-3、AJAX提交："><a href="#4-5-3、AJAX提交：" class="headerlink" title="4.5.3、AJAX提交："></a>4.5.3、AJAX提交：</h3><p>请求行，请求头，请求体都可以用来传值</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>AJAX提交<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Ajax提交&quot;</span> <span class="attr">id</span>=<span class="string">&quot;but1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/js/jquery-3.5.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&quot;#but-1&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> obj = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">        obj.<span class="property">name</span> = <span class="string">&quot;艾尔登成王记&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        obj.<span class="property">author</span> = <span class="string">&quot;宫崎英高&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        obj.<span class="property">price</span> = <span class="number">298.99</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> char = <span class="string">&quot;adbcldd&quot;</span></span></span><br><span class="line"><span class="language-javascript">        $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">url</span>:<span class="string">&quot;book/list&quot;</span>,  <span class="comment">//请求行传值</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>:<span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">beforeSend</span>: <span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title class_">XMLHttpRequest</span>.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxOD.....&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// contentType: &quot;application/json&quot;,</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// data: obj,//请求体传值</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-6、后端控制器接收前端提交的数据"><a href="#4-6、后端控制器接收前端提交的数据" class="headerlink" title="4.6、后端控制器接收前端提交的数据"></a>4.6、后端控制器接收前端提交的数据</h2><h3 id="4-6-1、请求行传值的接收方式"><a href="#4-6-1、请求行传值的接收方式" class="headerlink" title="4.6.1、请求行传值的接收方式"></a>4.6.1、请求行传值的接收方式</h3><ul>
<li>表单中的数据和Url提交都是请求行提交</li>
<li>AJAX中的url传值是请求行提交</li>
<li>ajax中的headers传值是请求头传值</li>
<li>ajax中的data是请求体传值</li>
</ul>
<p> URL的接收数据的方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/book&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line">    <span class="comment">/* &lt;p&gt;图书名字：&lt;input type=&quot;text&quot; name=&quot;name&quot;/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">    &lt;p&gt;图书作者：&lt;input type=&quot;text&quot; name=&quot;author&quot;/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">    &lt;p&gt;图书价格：&lt;input type=&quot;text&quot; name=&quot;price&quot;/&gt;&lt;/p&gt;*/</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String name,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;author&quot;)</span>String author,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;price&quot;)</span><span class="type">double</span> price)</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;bookadd=====&quot;</span>);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        System.out.println(author);</span><br><span class="line">        System.out.println(price);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果控制器中的方法中接收数据的 方法名，与传值的key（name）是一致的则可以省略掉**<code>@RequestParm(&quot;..&quot;)</code>**的注解</p>
<p>@RequestParm(“..”)括号里面是前端的name的值</p>
<ul>
<li><p>请求头传值接收数据的方式：前端页面在上面</p>
</li>
<li><p>后端接收值的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">list</span><span class="params">(<span class="meta">@RequestHeader(value = &quot;token&quot;,required = false)</span>String token)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;booklist=========&quot;</span>);</span><br><span class="line">    System.out.println(token);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong><code>@RequestHeader(&quot;..&quot;)</code></strong></p>
<h3 id="4-6-2-两种传值方式可以混在一起用"><a href="#4-6-2-两种传值方式可以混在一起用" class="headerlink" title="4.6.2 两种传值方式可以混在一起用"></a>4.6.2 两种传值方式可以混在一起用</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/book&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line">    <span class="comment">/* &lt;p&gt;图书名字：&lt;input type=&quot;text&quot; name=&quot;name&quot;/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">    &lt;p&gt;图书作者：&lt;input type=&quot;text&quot; name=&quot;author&quot;/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">    &lt;p&gt;图书价格：&lt;input type=&quot;text&quot; name=&quot;price&quot;/&gt;&lt;/p&gt;*/</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String name,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;author&quot;)</span>String author,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;price&quot;)</span><span class="type">double</span> price,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestHeader(&quot;token&quot;)</span> String token)</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;bookadd=====&quot;</span>);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        System.out.println(author);</span><br><span class="line">        System.out.println(price);</span><br><span class="line">        System.out.println(token);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>前端：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/js/jquery-3.5.1.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&quot;#but-1&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">url</span>:<span class="string">&quot;book/add?name=李四&amp;author=自然之力&amp;price=129.3&quot;</span>,  <span class="comment">//请求行传值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">type</span>:<span class="string">&quot;post&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">beforeSend</span>: <span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="title class_">XMLHttpRequest</span>.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxOD.....&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<p><img src="/2022/04/21/SpringMVC/image-20220410151711980.png" alt="image-20220410151711980"></p>
<h3 id="4-6-3、请求体的传值接收"><a href="#4-6-3、请求体的传值接收" class="headerlink" title="4.6.3、请求体的传值接收"></a>4.6.3、请求体的传值接收</h3><p>**<code>@RequestBody</code>**将前端请求体提交的Json格式数据转化为java对象，依赖jackson包</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    $(<span class="string">&quot;#but-1&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">        obj.<span class="property">name</span> = <span class="string">&quot;艾尔登成王记&quot;</span>;</span><br><span class="line">        obj.<span class="property">author</span> = <span class="string">&quot;宫崎英高&quot;</span>;</span><br><span class="line">        obj.<span class="property">price</span> = <span class="number">298.99</span>;</span><br><span class="line">        $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;book/update&quot;</span>,  <span class="comment">//请求行传值</span></span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">            <span class="attr">beforeSend</span>: <span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) &#123;</span><br><span class="line">                <span class="title class_">XMLHttpRequest</span>.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxOD.....&quot;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">contentType</span>: <span class="string">&quot;application/json;charset=UTF-8&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj),<span class="comment">//请求体传值</span></span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>控制器：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/update&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> Book book)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;updateBook----------&quot;</span>);</span><br><span class="line">    System.out.println(book);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2022/04/21/SpringMVC/image-20220410160542826.png" alt="image-20220410160542826"></p>
<h2 id="4-7、控制器响应前端请求"><a href="#4-7、控制器响应前端请求" class="headerlink" title="4.7、控制器响应前端请求"></a>4.7、控制器响应前端请求</h2><ul>
<li>同步请求：form，超链接</li>
<li>异步请求：ajax</li>
</ul>
<h3 id="4-7-1、处理同步请求的方法"><a href="#4-7-1、处理同步请求的方法" class="headerlink" title="4.7.1、处理同步请求的方法:"></a>4.7.1、处理同步请求的方法:</h3><ul>
<li><p>将控制器的返回类型定义为Sting或者ModeAndView，实现页面的跳转</p>
<p><strong>请求跳转</strong>：</p>
<ul>
<li><p>返回类型为String：</p>
<p>直接return jsp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/book&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line">    <span class="comment">/* &lt;p&gt;图书名字：&lt;input type=&quot;text&quot; name=&quot;name&quot;/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">    &lt;p&gt;图书作者：&lt;input type=&quot;text&quot; name=&quot;author&quot;/&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">    &lt;p&gt;图书价格：&lt;input type=&quot;text&quot; name=&quot;price&quot;/&gt;&lt;/p&gt;*/</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String  <span class="title function_">add</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String name,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;author&quot;)</span>String author,</span></span><br><span class="line"><span class="params">                    <span class="meta">@RequestParam(&quot;price&quot;)</span><span class="type">double</span> price</span></span><br><span class="line"><span class="params">                   )</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;bookadd=====&quot;</span>);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        System.out.println(author);</span><br><span class="line">        System.out.println(price);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/tips.jsp&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p><img src="/2022/04/21/SpringMVC/image-20220410161901358.png" alt="image-20220410161901358"></p>
<p><strong>请求跳转</strong>：</p>
<p>返回类型为ModelView</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;/tips.jsp&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> modelAndView;</span><br></pre></td></tr></table></figure>

<p>重定向：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">&quot;redirect:/tips.jsp&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;redirect:/tips.jsp&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> modelAndView;</span><br></pre></td></tr></table></figure>

<h3 id="4-7-2、处理异步请求的方法"><a href="#4-7-2、处理异步请求的方法" class="headerlink" title="4.7.2、处理异步请求的方法:"></a>4.7.2、处理异步请求的方法:</h3><p>ajax：</p>
<ul>
<li><p>使用response中的输出流进行响应</p>
<ul>
<li><p>控制器中的方法返回类型必须为void</p>
</li>
<li><p>必须要给出response对象，在我们的方法中加上<code>HttpServletResponse response</code> 参数</p>
</li>
<li><p>在方法中获取输出流 进行响应</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/update&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> Book book ,HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;updateBook----------&quot;</span>);</span><br><span class="line">    System.out.println(book);</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().writeValueAsString(book);</span><br><span class="line">    resp.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">    resp.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">    <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">    writer.write(s);</span><br><span class="line">    writer.flush();</span><br><span class="line">    writer.close();</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>直接在控制器方法返回响应的对象</p>
<ul>
<li>控制器方法的返回类型写成返回的pojo类型</li>
<li>在控制器方法前添加**@ResponseBody**注解</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">update</span><span class="params">()</span>  &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;updateBook----------&quot;</span>);</span><br><span class="line"><span class="comment">//        System.out.println(book);</span></span><br><span class="line">        <span class="type">List</span> <span class="variable">bookList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Book&gt;();</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="number">1</span>, <span class="string">&quot;天龙八部&quot;</span>, <span class="string">&quot;金庸&quot;</span>, <span class="number">322.3</span>);</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="number">2</span>, <span class="string">&quot;倚天屠龙记&quot;</span>, <span class="string">&quot;金庸&quot;</span>, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        bookList.add(book1);</span><br><span class="line">        bookList.add(book2);</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;book/update&quot;</span>,  <span class="comment">//请求行传值</span></span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">    <span class="attr">beforeSend</span>: <span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) &#123;</span><br><span class="line">        <span class="title class_">XMLHttpRequest</span>.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxOD.....&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">contentType</span>: <span class="string">&quot;application/json;charset=UTF-8&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: d,<span class="comment">//请求体传值</span></span><br><span class="line">    <span class="attr">dataType</span>:<span class="string">&quot;json&quot;</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/21/SpringMVC/image-20220410170203556.png" alt="image-20220410170203556"></p>
<p><strong>如果在一个类中所有控制器的请求都是处理异步请求，我们只需要在类的上面加上<code>@ResponseBody</code>的注解</strong></p>
<h3 id="4-7-3、控制器响应同步请求的数据传递"><a href="#4-7-3、控制器响应同步请求的数据传递" class="headerlink" title="4.7.3、控制器响应同步请求的数据传递:"></a>4.7.3、控制器响应同步请求的数据传递:</h3><p>对于同步请求的转发响应，我们可以传递参数到转发的页面，</p>
<ul>
<li>返回类型为String的时候该如何传值<ul>
<li>在控制器方法中添加一个Model model的参数</li>
<li>在return之前model.addAttriute(“key”,”value”)</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String name,</span></span><br><span class="line"><span class="params">                           <span class="meta">@RequestParam(&quot;author&quot;)</span>String author,</span></span><br><span class="line"><span class="params">                           <span class="meta">@RequestParam(&quot;price&quot;)</span><span class="type">double</span> price,</span></span><br><span class="line"><span class="params">                           Model model)</span> &#123;</span><br><span class="line">       </span><br><span class="line">       model.addAttribute(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">       model.addAttribute(<span class="string">&quot;Book&quot;</span>,<span class="keyword">new</span> <span class="title class_">Book</span>(<span class="number">1</span>,<span class="string">&quot;雪中悍刀行&quot;</span>,<span class="string">&quot;黄蛮儿&quot;</span>,<span class="number">71.3</span>));</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;/tips.jsp&quot;</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/21/SpringMVC/image-20220410202704468.png" alt="image-20220410202704468"></p>
<p>也可以直接加一个HttpServletRequest req对象</p>
<p>req.setAttribute(“key”,value);</p>
<ul>
<li>如果返回类型为ModelAndView时该如何传值</li>
</ul>
<p>可以直接通过ModelAndView来传值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/add2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">add2</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String name,</span></span><br><span class="line"><span class="params">                        <span class="meta">@RequestParam(&quot;author&quot;)</span>String author,</span></span><br><span class="line"><span class="params">                        <span class="meta">@RequestParam(&quot;price&quot;)</span><span class="type">double</span> price)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;/tips.jsp&quot;</span>);</span><br><span class="line">    modelAndView.addObject(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">    modelAndView.addObject(<span class="string">&quot;Book&quot;</span>,<span class="keyword">new</span> <span class="title class_">Book</span>(<span class="number">2</span>,<span class="string">&quot;天龙八部&quot;</span>,<span class="string">&quot;金庸&quot;</span>,<span class="number">731.3</span>));</span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-8、解决中文乱码问题"><a href="#4-8、解决中文乱码问题" class="headerlink" title="4.8、解决中文乱码问题"></a>4.8、解决中文乱码问题</h2><ul>
<li>前端的编码问题</li>
<li>后端的编码问题</li>
<li>传输的过程的编码问题</li>
</ul>
<h3 id="4-8-1、前端编码的设置"><a href="#4-8-1、前端编码的设置" class="headerlink" title="4.8.1、前端编码的设置"></a>4.8.1、前端编码的设置</h3><ul>
<li>JSP页面</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span> pageEncoding=<span class="string">&quot;utf-8&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>HTML页面</p>
<head> 
    <meta charset="utf-8"> 
</head></li>
</ul>
<h3 id="4-8-2、服务器编码问题"><a href="#4-8-2、服务器编码问题" class="headerlink" title="4.8.2、服务器编码问题"></a>4.8.2、服务器编码问题</h3><ul>
<li>tomcat</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">&quot;8080&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-8-3、设置SpringMVC的编码方式、"><a href="#4-8-3、设置SpringMVC的编码方式、" class="headerlink" title="4.8.3、设置SpringMVC的编码方式、"></a>4.8.3、设置SpringMVC的编码方式、</h3><ul>
<li>编码过滤器，在web.xml中配置SpringMVC的编码过滤器方式</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--解决控制台打印乱码问题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>charset<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>charset<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/21/SpringMVC/image-20220410210347681.png" alt="image-20220410210347681"></p>
<h1 id="四、SpringMVC的请求处理流程"><a href="#四、SpringMVC的请求处理流程" class="headerlink" title="四、SpringMVC的请求处理流程"></a>四、SpringMVC的请求处理流程</h1><p>springmvc通过前端控制器DispatcherServlet拦截并处理请求</p>
<h2 id="4-1、请求的流程"><a href="#4-1、请求的流程" class="headerlink" title="4.1、请求的流程"></a>4.1、请求的流程</h2><p><img src="/2022/04/21/SpringMVC/image-20220410213742662.png" alt="image-20220410213742662"></p>
<h2 id="4-2、SpringMVC的核心组件"><a href="#4-2、SpringMVC的核心组件" class="headerlink" title="4.2、SpringMVC的核心组件"></a>4.2、SpringMVC的核心组件</h2><ul>
<li>DispatcherServlet 前端控制器 ，总控制器<ul>
<li>作用：接受请求，协同各组件工作，响应请求</li>
</ul>
</li>
<li>HandlerMapping处理器映射器**(可自定义配置)**<ul>
<li>作用：负责更具用户请求的url找到对于的Handler</li>
</ul>
</li>
<li>HandlerAdapter处理器适配器<ul>
<li>作用：根据HandlerMapping解析的调用链通过适配器模式来完成Handler的调用</li>
</ul>
</li>
<li>Handler处理器&#x2F;控制器<ul>
<li>由工程师根据业务的需求来进行开发</li>
<li>作用：处理请求的</li>
</ul>
</li>
<li>ModelAndView 模型和数据&#x2F;视图模型<ul>
<li>作用：用于封装处理器返回的数据和响应的视图</li>
<li>Model+View</li>
</ul>
</li>
<li>ViewResolver 视图解析器**(可自定义配置)**<ul>
<li>作用：对ModelAndView进行解析</li>
</ul>
</li>
<li>View 视图<ul>
<li>视图渲染，完成数据的渲染</li>
</ul>
</li>
</ul>
<h2 id="4-3、处理器映射器"><a href="#4-3、处理器映射器" class="headerlink" title="4.3、处理器映射器"></a>4.3、处理器映射器</h2><p>不同的处理器映射器对URL处理的方式也不相同，使用对应的处理器映射器之后我们的前端请求规则也需要发生相应的变化</p>
<ul>
<li>springmvc提供的处理器映射器<ul>
<li>BeanNameHandlerMapping(根据控制器的id访问控制器)</li>
<li>SimpleUrlHandlerMapping 根据配置的url来进行访问</li>
</ul>
</li>
</ul>
<p>配置BeanNameHandlerMapping：</p>
<p>在Spring-servlet.xml中配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="4-4、视图解析器"><a href="#4-4、视图解析器" class="headerlink" title="4.4、视图解析器"></a>4.4、视图解析器</h2><ul>
<li><p>UrlBasedViewResolver</p>
<ul>
<li><p>依赖与Jstl包</p>
</li>
<li><p>&#96;&#96;&#96;xml</p>
<!-- https://mvnrepository.com/artifact/javax.servlet/jstl -->
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>jstl</artifactId>
    <version>1.2</version>
</dependency>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">* 配置视图解析器</span><br><span class="line"></span><br><span class="line">* ```xml</span><br><span class="line">  &lt;bean class=&quot;org.springframework.web.servlet.view.UrlBasedViewResolver&quot;&gt;</span><br><span class="line">      &lt;property name=&quot;prefix&quot; value=&quot;/&quot;/&gt;</span><br><span class="line">      &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;</span><br><span class="line">      &lt;property name=&quot;viewClass&quot; value=&quot;org.springframework.web.servlet.view.JstlView&quot;/&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>后端控制器代码：</p>
<p><img src="/2022/04/21/SpringMVC/image-20220410221211999.png" alt="image-20220410221211999"></p>
</li>
<li><p>InternalResourceViewResolver</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.UrlBasedViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="五、日期格式处理"><a href="#五、日期格式处理" class="headerlink" title="五、日期格式处理"></a>五、日期格式处理</h1><p>如果前端需要输入日期数据，在springmvc中要求必须日期格式为</p>
<p><strong>yyyy&#x2F;MM&#x2F;dd</strong></p>
<p>如果日期格式必须为指定格式，但是springmvc不接受如何处理？</p>
<ul>
<li>自定义转换日期</li>
</ul>
<h2 id="5-1、创建自定义的日期转换器"><a href="#5-1、创建自定义的日期转换器" class="headerlink" title="5.1、创建自定义的日期转换器"></a>5.1、创建自定义的日期转换器</h2><h3 id="5-1-1创建自定义的转换类"><a href="#5-1-1创建自定义的转换类" class="headerlink" title="5.1.1创建自定义的转换类"></a>5.1.1创建自定义的转换类</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1、创建一个类来实现日期转换把String转换成Date</span></span><br><span class="line"><span class="comment"> * 2、实现转换的方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDateConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String , Date&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//s表示用户输入的格式</span></span><br><span class="line">    <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">convert</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(s.contains(<span class="string">&quot;-&quot;</span>))&#123;</span><br><span class="line">            <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">            date=sdf.parse(s);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (s.contains(<span class="string">&quot;年&quot;</span>))&#123;</span><br><span class="line">            sdf = <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy年MM月dd日&quot;</span>);</span><br><span class="line">            date=sdf.parse(s);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (s.contains(<span class="string">&quot;号&quot;</span>))&#123;</span><br><span class="line">            sdf = <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy年MM月dd号&quot;</span>);</span><br><span class="line">            date=sdf.parse(s);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (s.contains(<span class="string">&quot;/&quot;</span>))&#123;</span><br><span class="line">            sdf = <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy/MM/dd&quot;</span>);</span><br><span class="line">           date=sdf.parse(s);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.matches(<span class="string">&quot;\\d&#123;8&#125;&quot;</span>))&#123;</span><br><span class="line">            sdf = <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">            date=sdf.parse(s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> date;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-1-2将这个写转换器配置给springmvc"><a href="#5-1-2将这个写转换器配置给springmvc" class="headerlink" title="5.1.2将这个写转换器配置给springmvc"></a>5.1.2将这个写转换器配置给springmvc</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">&quot;ConverterFactory&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--存放转换器的工厂--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ConverterFactory&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;converters&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.dhj.util.MyDateConverter&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试后每个日期格式都有用</p>
<h1 id="六、文件上传"><a href="#六、文件上传" class="headerlink" title="六、文件上传"></a>六、文件上传</h1><h2 id="6-1、SpringMVC的项目部署"><a href="#6-1、SpringMVC的项目部署" class="headerlink" title="6.1、SpringMVC的项目部署"></a>6.1、SpringMVC的项目部署</h2><ul>
<li>添加项目所需要的依赖<ul>
<li>spring-web</li>
<li>spring-jdbc</li>
<li>spring-aspect</li>
<li>spring-context</li>
<li>spring-test</li>
<li>spring-webmvc</li>
<li>jackson</li>
</ul>
</li>
<li>创建springmvc的配置文件</li>
<li>在web.xml中加入SpringMVC的前端控制器</li>
<li>在web.xml中配置编码过滤器</li>
<li>配置SpringMVC的静态资源策略</li>
</ul>
<h2 id="6-2、添加图书上传文件（图书的封面）"><a href="#6-2、添加图书上传文件（图书的封面）" class="headerlink" title="6.2、添加图书上传文件（图书的封面）"></a>6.2、添加图书上传文件（图书的封面）</h2><ul>
<li><p>表单提交 的方式为post</p>
</li>
<li><p>表单的enctype必须为:multipart&#x2F;form-data</p>
</li>
<li><p>文件上传需要借助于CommonsMultipartResolver</p>
<ul>
<li>添加依赖</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在spring-servlet.xml中配置文件解析器</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        设置文件最大的上传大小 单位是字节--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20240000&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        设置内存缓存编码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxInMemorySize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;102400&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        设置编码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;utf-8&quot;</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">     &lt;/bean</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<ul>
<li><p>控制器接收图片</p>
<p>在方法里放一个MultipartFile对象，就可以接收到值了</p>
<p>对象的名字要和前端上传的图像的名字一致</p>
</li>
<li><p>用对象接收前端传来的 值前端的name属性要和后端的实体对象的属性名字一致</p>
</li>
</ul>
<p>后端代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/addBook&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">addBook</span><span class="params">(Book book, Model model, MultipartFile imgFile</span></span><br><span class="line"><span class="params">                                , HttpServletRequest request</span></span><br><span class="line"><span class="params">                                )</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;redirect:/pages/index.html&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//    1、获取到上传的图片</span></span><br><span class="line">  <span class="comment">//  System.out.println(imgFile);</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> imgFile.getOriginalFilename();</span><br><span class="line">    <span class="type">String</span> <span class="variable">suffix</span> <span class="operator">=</span> originalFilename.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">1</span>]; <span class="comment">// jpg</span></span><br><span class="line"><span class="comment">//    System.out.println(suffix);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  2、  生成图片文件的名称 利用hutool随机工具包</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> RandomUtil.randomString(<span class="number">8</span>);</span><br><span class="line">    fileName=fileName+<span class="string">&quot;.&quot;</span>+suffix;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//  3  、获取imgs目录在服务器的路径</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">imgsDir</span> <span class="operator">=</span> request.getServletContext().getRealPath(<span class="string">&quot;imgs&quot;</span>);</span><br><span class="line"><span class="comment">//    System.out.println(fileName);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  4、存储路径</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">save</span> <span class="operator">=</span> imgsDir+<span class="string">&quot;/&quot;</span>+fileName;</span><br><span class="line"><span class="comment">//	5、保存文件</span></span><br><span class="line">    imgFile.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(save));</span><br><span class="line"><span class="comment">//	6、设置图片的访问路径</span></span><br><span class="line">    book.setBookImg(<span class="string">&quot;imgs\\&quot;</span>+fileName);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  7、调用service保存图片到数据库</span></span><br><span class="line"><span class="comment">//			 ...</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    model.addAttribute(<span class="string">&quot;Book&quot;</span>,book);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>hutool的依赖:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/cn.hutool/hutool-all --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.7.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="6-3、文件下载"><a href="#6-3、文件下载" class="headerlink" title="6.3、文件下载"></a>6.3、文件下载</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;h3&gt;文件列表&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $.<span class="title function_">get</span>(<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/book/listBook&quot;</span>, <span class="keyword">function</span> (<span class="params">resp</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(resp)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,<span class="string">&quot;json&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>后端发过来的数据：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/listBook&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String[] listBook(HttpServletRequest request)&#123;</span><br><span class="line">    <span class="comment">//从img目录下获取所有的图片信息</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">imgs</span> <span class="operator">=</span> request.getServletContext().getRealPath(<span class="string">&quot;imgs&quot;</span>);</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(imgs);</span><br><span class="line"></span><br><span class="line">    String[] fileNames = file.list();</span><br><span class="line">    <span class="comment">// 返回所有的的文件名</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fileNames;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在booklist.jsp中下载的超链接改路径</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    $.<span class="title function_">get</span>(<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/book/listBook&quot;</span>, <span class="keyword">function</span> (<span class="params">resp</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(resp)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; resp.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> fn = resp[i];</span><br><span class="line">            <span class="keyword">var</span> htmlStr = <span class="string">&quot; &lt;div class=&#x27;col-lg-2 col-md-4 col-sm-5 col-xs-6&#x27;&gt;&lt;div class=&#x27;thumbnail&#x27;&gt;&lt;img src=&#x27;imgs/&quot;</span>+fn+<span class="string">&quot;&#x27; alt=&#x27;...&#x27;&gt;&lt;div class=&#x27;caption&#x27;&gt;&lt;p&gt;&lt;a href=&#x27;$&#123;pageContext.request.contextPath&#125;/book/bookDownload?fname=&quot;</span>+fn+<span class="string">&quot;&#x27; class=&#x27;btn btn-primary&#x27; role=&#x27;button&#x27;&gt;下载&lt;/a&gt; &lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\t&quot;</span></span><br><span class="line">            $(<span class="string">&quot;#container&quot;</span>).<span class="title function_">append</span>(htmlStr)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="string">&quot;json&quot;</span>);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>在到控制器去写一个controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/bookDownload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">downLoadImg</span><span class="params">(String fname, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//从imgs目录找到当前文件</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">imgs</span> <span class="operator">=</span> request.getServletContext().getRealPath(<span class="string">&quot;imgs&quot;</span>);</span><br><span class="line">    <span class="comment">//找到用户要下载的图片</span></span><br><span class="line">    String filePath=imgs+<span class="string">&quot;\\&quot;</span>+fname;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取图片的输入路径</span></span><br><span class="line">    <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath);</span><br><span class="line"></span><br><span class="line"><span class="comment">//    获取输出流</span></span><br><span class="line">    <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    response.setContentType(<span class="string">&quot;application/exe;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//   让浏览器识别图片</span></span><br><span class="line">    response.addHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span>+fname);</span><br><span class="line"></span><br><span class="line">    IOUtils.copy(fileInputStream,outputStream);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="七、统一异常处理"><a href="#七、统一异常处理" class="headerlink" title="七、统一异常处理"></a>七、统一异常处理</h1><p>在我们的应用系统运行的过程中，可能由于环境，用户操作，资源不足等原因导致系统出现的异常 ，如果系统出现异常，将会通过浏览器呈现给用户，这种异常的显示是没必要的，我们可以在服务器 进行处理</p>
<h2 id="7-1、Http异常状态的统一处理"><a href="#7-1、Http异常状态的统一处理" class="headerlink" title="7.1、Http异常状态的统一处理"></a>7.1、Http异常状态的统一处理</h2><p>Http status 404—-&gt;</p>
<ul>
<li><p>创建一个用于进行页面处理的jsp 404.jsp</p>
<p>在webxml下进行配置i</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/404.jsp<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="7-2-1、java代码异常的统一处理"><a href="#7-2-1、java代码异常的统一处理" class="headerlink" title="7.2.1、java代码异常的统一处理"></a>7.2.1、java代码异常的统一处理</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exception-type</span>&gt;</span>java.lang.Exception<span class="tag">&lt;/<span class="name">exception-type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/404.jsp<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span>		</span><br></pre></td></tr></table></figure>

<h2 id="7-2-2、SpringMvc-处理异常-的方式"><a href="#7-2-2、SpringMvc-处理异常-的方式" class="headerlink" title="7.2.2、SpringMvc 处理异常 的方式"></a>7.2.2、SpringMvc 处理异常 的方式</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(NullPointerException.class)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">nullHandlder</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(NumberFormatException.class)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">formatHandlder</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义一个类来进行异常处理</p>
<h1 id="八、拦截器"><a href="#八、拦截器" class="headerlink" title="八、拦截器"></a>八、拦截器</h1><h2 id="8-1、拦截器介绍"><a href="#8-1、拦截器介绍" class="headerlink" title="8.1、拦截器介绍"></a>8.1、拦截器介绍</h2><p>springMVC 提供的拦截器就类似于Servlet—api中的过滤器，可以对控制器中的请求进行拦截，进行预处理。</p>
<ul>
<li>过滤器<ul>
<li>是Servlet规范的一部分，所有的web项目都可以使用</li>
</ul>
</li>
<li>拦截器<ul>
<li>是SpringMVC的实现，并不是所有的都能用</li>
<li>拦截器在 SpringMVC的文件中配置，不会拦截SpringMvc放行的资源</li>
</ul>
</li>
</ul>
<h2 id="8-2、自定义拦截器"><a href="#8-2、自定义拦截器" class="headerlink" title="8.2、自定义拦截器"></a>8.2、自定义拦截器</h2><ul>
<li>创建拦截器（实现HandlerInterceptor的接口）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//实现HanderInterceptor的拦截器</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预处理的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;预处理的方法&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 后处理的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> modelAndView</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后处理的的方法&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>到SpringMVC中配置拦截器</li>
</ul>
<p>path里写controller的路径</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--    p配置拦截器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;#&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;#&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.dhj.util.MyInterceptor&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/21/SpringMVC/image-20220413202820746.png" alt="image-20220413202820746"></p>
<h2 id="8-3-拦截器链"><a href="#8-3-拦截器链" class="headerlink" title="8.3 拦截器链"></a>8.3 拦截器链</h2><p>将多个拦截器拦截同一个控制器的时候，按照你配置的顺序执行</p>
<p><strong>预处理1–&gt;预处理2—&gt;controller()—-&gt;后处理2—-&gt;后处理1</strong></p>
<h1 id="九、SpringMVC整合Spring和Mybatis"><a href="#九、SpringMVC整合Spring和Mybatis" class="headerlink" title="九、SpringMVC整合Spring和Mybatis"></a>九、SpringMVC整合Spring和Mybatis</h1><h2 id="9-1"><a href="#9-1" class="headerlink" title="9.1"></a>9.1</h2><ul>
<li>创建maven web项目</li>
<li>将maven中pom文件packing 写成war</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在main下创建webapp包和WEB-INF</li>
<li>在WEB—INF中创建web.xml</li>
<li>添加web依赖jsp和servlet</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet/jsp-api --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>配置服务器运行环境</li>
</ul>
<p><img src="/2022/04/21/SpringMVC/image-20220413205057451.png" alt="image-20220413205057451"></p>
<h2 id="9-2、部署MyBatis"><a href="#9-2、部署MyBatis" class="headerlink" title="9.2、部署MyBatis"></a>9.2、部署MyBatis</h2><ul>
<li>添加mybatis依赖<ul>
<li>lombok</li>
<li>mybatis</li>
<li>mysql-connector-java</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--mybatis依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--java连接数据库的依赖mysql的驱动--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;-- lombok依赖--&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在resources目录中创建mybaits配置文件 <code>mybatis-config</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="9-3、部署Spring和SpringMvc"><a href="#9-3、部署Spring和SpringMvc" class="headerlink" title="9.3、部署Spring和SpringMvc"></a>9.3、部署Spring和SpringMvc</h2><ul>
<li>添加依赖<ul>
<li>spring-context  </li>
<li>spring-aspects </li>
<li>spring-jdbc   整合mybatis</li>
<li>spring-test</li>
<li>spring-web</li>
<li>spring-webmvc</li>
<li>jackson   解析json</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-version</span>&gt;</span>5.3.18<span class="tag">&lt;/<span class="name">spring-version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="9-3-1、创建spring配置文件"><a href="#9-3-1、创建spring配置文件" class="headerlink" title="9.3.1、创建spring配置文件"></a>9.3.1、创建spring配置文件</h3><ul>
<li><p>创建多配置文件 </p>
<ul>
<li>spring-context.xml 只配置注解声明，以及类的管理 ioc</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">          https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">          http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">          http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--声明使用注解配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- more bean definitions go here --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 声明spring工厂注解扫描的范围--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dhj&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>spring-mvc.xml只进行mvc的相关配置 如静态资源和拦截器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans-4.2.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/mvc/spring-mvc-4.2.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       &quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明mvc使用注解驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">   <span class="comment">&lt;!--日期转换器和拦截器--&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>spring-mybatis.xml 进行spring于mybatis整合的配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- more bean definitions go here --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="9-3-2、配置前端控制器"><a href="#9-3-2、配置前端控制器" class="headerlink" title="9.3.2、配置前端控制器"></a>9.3.2、配置前端控制器</h3><ul>
<li><p>在webxml中配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-*.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="9-4、整合ssm"><a href="#9-4、整合ssm" class="headerlink" title="9.4、整合ssm"></a>9.4、整合ssm</h2><h3 id="9-4-1、导入mybatis-spring的依赖"><a href="#9-4-1、导入mybatis-spring的依赖" class="headerlink" title="9.4.1、导入mybatis-spring的依赖"></a>9.4.1、导入mybatis-spring的依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        mybatis-spring --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-2、配置的druid的依赖"><a href="#9-4-2、配置的druid的依赖" class="headerlink" title="9.4.2、配置的druid的依赖"></a>9.4.2、配置的druid的依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-3、创建druid的配置"><a href="#9-4-3、创建druid的配置" class="headerlink" title="9.4.3、创建druid的配置"></a>9.4.3、创建druid的配置</h3><p>druid.properties</p>
<ul>
<li>在spring-mybatis.xml中配置数据源</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:druid.properties&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span> <span class="attr">id</span>=<span class="string">&quot;druidDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.Driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxActive&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.pool.maxActive&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.pool.minIdle&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxWait&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;druid.pool.timeout&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-4、创建SqlSessionFactory"><a href="#9-4-4、创建SqlSessionFactory" class="headerlink" title="9.4.4、创建SqlSessionFactory"></a>9.4.4、创建SqlSessionFactory</h3><p>在spring-mybatis.xml中配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;druidDataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        mapper文件的位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mappers/*.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        取别名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;typeAliasesPackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.dhj.pojo&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-4、配置MapperScannerConfigurer"><a href="#9-4-4、配置MapperScannerConfigurer" class="headerlink" title="9.4.4、配置MapperScannerConfigurer"></a>9.4.4、配置MapperScannerConfigurer</h3><p>用spring来获取dao对象</p>
<ul>
<li>在spring-mybatis里配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.dhj.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sessionFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="9-5、整合配置AOP"><a href="#9-5、整合配置AOP" class="headerlink" title="9.5、整合配置AOP"></a>9.5、整合配置AOP</h2><p>使用spring提供的事务管理类完成事务管理一般采用注解</p>
<p>基于注解的配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--基于注解的事务管理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;druidDataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="十、测试"><a href="#十、测试" class="headerlink" title="十、测试"></a>十、测试</h1><ul>
<li><h2 id="10-1、创建实体类："><a href="#10-1、创建实体类：" class="headerlink" title="10.1、创建实体类："></a>10.1、创建实体类：</h2></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dhj.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="type">int</span> userId;</span><br><span class="line">    <span class="keyword">private</span>  String userName;</span><br><span class="line">    <span class="keyword">private</span>  String userPassword;</span><br><span class="line">    <span class="keyword">private</span>  String userRealname;</span><br><span class="line">    <span class="keyword">private</span>  String userImg;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><h2 id="10-2、在dao中创建接口"><a href="#10-2、在dao中创建接口" class="headerlink" title="10.2、在dao中创建接口"></a>10.2、在dao中创建接口</h2></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dhj.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dhj.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过姓名来查询User</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    User <span class="title function_">queryUserByName</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><h2 id="10-3、在mappers包下创建映射文件"><a href="#10-3、在mappers包下创建映射文件" class="headerlink" title="10.3、在mappers包下创建映射文件"></a>10.3、在mappers包下创建映射文件</h2></li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.dhj.dao.UserDao&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.dhj.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;userId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userPassword&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_password&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userRealname&quot;</span> <span class="attr">column</span>=<span class="string">&quot;real_name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userImg&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_img&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUserByName&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span>&gt;</span></span><br><span class="line">        select id,user_name,user_password,real_name,user_img</span><br><span class="line">        from `user`</span><br><span class="line">        where `user_name`=#&#123;userName&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h2 id="10-4、使用单元测试测试Dao"><a href="#10-4、使用单元测试测试Dao" class="headerlink" title="10.4、使用单元测试测试Dao"></a>10.4、使用单元测试测试Dao</h2><ul>
<li>单元测试的依赖</li>
</ul>
</li>
</ul>
<p>​	</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>创建测试类：</li>
</ul>
<h1 id="十一、MybatisGenerator"><a href="#十一、MybatisGenerator" class="headerlink" title="十一、MybatisGenerator"></a>十一、MybatisGenerator</h1><h2 id="11-1、创建generatorConfig-xml文件"><a href="#11-1、创建generatorConfig-xml文件" class="headerlink" title="11.1、创建generatorConfig.xml文件"></a>11.1、创建generatorConfig.xml文件</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数据库驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">classPathEntry</span>    <span class="attr">location</span>=<span class="string">&quot;C:\Users\ddg\.m2\repository\mysql\mysql-connector-java\5.1.47\mysql-connector-java-5.1.47.jar&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;context&quot;</span>    <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suppressDate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suppressAllComments&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据库链接地址账号密码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span></span></span><br><span class="line"><span class="tag">                <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis-study?useSSL=false<span class="symbol">&amp;amp;</span>characterEncoding=utf-8&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">password</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;forceBigDecimals&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成Model类存放位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.dhj.pojo&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;trimStrings&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成映射文件存放位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;mappers&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/resources&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成Dao类存放位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.dhj.dao&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成对应表及类名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;user&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;User1&quot;</span> <span class="attr">mapperName</span>=<span class="string">&quot;User1Mapper&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="11-2、创建启动类"><a href="#11-2、创建启动类" class="headerlink" title="11.2、创建启动类"></a>11.2、创建启动类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dhj.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.exception.InvalidConfigurationException;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.exception.XMLParserException;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MBG</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span>  Exception &#123;</span><br><span class="line">        <span class="comment">//MBG执行过程中的警告信息</span></span><br><span class="line">        List&lt;String&gt; warnings = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        <span class="comment">//生成代码重复时，是否覆盖源代码</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">override</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> Thread.currentThread().getContextClassLoader().getResourceAsStream(<span class="string">&quot;generatorConfig.xml&quot;</span>);</span><br><span class="line">        <span class="type">ConfigurationParser</span> <span class="variable">cp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConfigurationParser</span>(warnings);</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">config</span> <span class="operator">=</span> cp.parseConfiguration(in);</span><br><span class="line"></span><br><span class="line">        <span class="type">DefaultShellCallback</span> <span class="variable">callback</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultShellCallback</span>(override);</span><br><span class="line">        <span class="comment">//创建MBG</span></span><br><span class="line">        <span class="type">MyBatisGenerator</span> <span class="variable">mbg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyBatisGenerator</span>(config, callback, warnings);</span><br><span class="line">        mbg.generate(<span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//输出警告信息</span></span><br><span class="line">        <span class="keyword">for</span> (String warn : warnings) &#123;</span><br><span class="line">            System.out.println(warn);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行就行</p>
<h2 id="11-3、创建一个批量的测试数据"><a href="#11-3、创建一个批量的测试数据" class="headerlink" title="11.3、创建一个批量的测试数据"></a>11.3、创建一个批量的测试数据</h2><p>自动生成的xml文件中有一个叫做int insertSelective(User1 record);的方法</p>
<p>批量执行再spring-mybatis里加一个叫做SqlSessionTemplate的类，这样就可以完成批量操作</p>
<p>让他自动注入 </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--    执行批量操作的SqlSession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span> <span class="attr">id</span>=<span class="string">&quot;sqlSession&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;executorType&quot;</span> <span class="attr">value</span>=<span class="string">&quot;BATCH&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建测试类：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(&#123;&quot;classpath:/spring-context.xml&quot;,&quot;classpath:/spring-mvc.xml&quot;,&quot;classpath:/spring-mybatis.xml&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User1MapperTest</span> &#123;</span><br><span class="line">    </span><br><span class="line">      <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> User1Mapper user1Dao;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SqlSession sqlSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertSelective</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//测试插入一条数据</span></span><br><span class="line">   <span class="comment">// user1Dao.insertSelective(new User1(null,&quot;dawanshangd&quot;,&quot;password&quot;,&quot;realname&quot;,&quot;userimg&quot;));</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//插入批量的数据 用于测试使用可以执行批量操作的SqlSession</span></span><br><span class="line"> <span class="comment">/*   for()&#123;</span></span><br><span class="line"><span class="comment">        // user1Dao.insertSelective(new User1(null,&quot;dawanshangd&quot;,&quot;password&quot;,&quot;realname&quot;,&quot;userimg&quot;));</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="comment">//配置一个可以执行批量的sqlsession</span></span><br><span class="line">    <span class="type">User1Mapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(User1Mapper.class);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> RandomUtil.randomString(<span class="number">5</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> RandomUtil.randomString(<span class="number">5</span>);</span><br><span class="line">        mapper.insertSelective(<span class="keyword">new</span> <span class="title class_">User1</span>(<span class="literal">null</span>,s,<span class="string">&quot;123&quot;</span>,s2,s+<span class="string">&quot;.img&quot;</span>));</span><br><span class="line">    	&#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;批量插入完成！！&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/21/SpringMVC/image-20220415004124140.png" alt="image-20220415004124140"></p>
<p>插入完成！测试数据有了</p>
<h2 id="11-4、"><a href="#11-4、" class="headerlink" title="11.4、"></a>11.4、</h2></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">DaiHaojun</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://daihaojun554.github.io/2022/04/21/SpringMVC/">http://daihaojun554.github.io/2022/04/21/SpringMVC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SpringMVC/">SpringMVC</a><a class="post-meta__tags" href="/tags/Spring/">Spring</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2022/04/21/MyBatis/"><i class="fa fa-chevron-left">  </i><span>MyBatis</span></a></div><div class="next-post pull-right"><a href="/2022/04/21/SpringBoot/"><span>SpringBoot</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By DaiHaojun</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://daihaojun.top">blog</a>!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://lib.baomitu.com/animejs/latest/anime.min.js"></script><script src="https://lib.baomitu.com/jquery/latest/jquery.min.js"></script><script src="https://lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script src="https://lib.baomitu.com/velocity/latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>