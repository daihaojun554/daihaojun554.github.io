<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="springboot运维篇"><meta name="keywords" content="springboot,运维"><meta name="author" content="DaiHaojun"><meta name="copyright" content="DaiHaojun"><title>springboot运维篇 | myblog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.1.0'
} </script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="myblog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E8%BF%90%E7%BB%B4%E7%AF%87"><span class="toc-number">1.</span> <span class="toc-text">SpringBoot运维篇</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81springboot%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%89%93%E5%8C%85"><span class="toc-number">2.</span> <span class="toc-text">一、springboot项目的打包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1%E3%80%81Window%E7%89%88%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">1.1、Window版：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2%E3%80%81linux%E7%89%88%EF%BC%9A"><span class="toc-number">2.2.</span> <span class="toc-text">1.2、linux版：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1%E3%80%81%E5%90%8E%E5%8F%B0%E5%90%AF%E5%8A%A8%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.2.1、后台启动的命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2%E3%80%81%E4%B8%B4%E6%97%B6%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-number">2.2.2.</span> <span class="toc-text">1.2.2、临时的属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3%E3%80%81%E4%B8%B4%E6%97%B6%E5%B1%9E%E6%80%A7%E5%9C%A8IDEA%E4%B8%AD%E8%AE%BE%E7%BD%AE"><span class="toc-number">2.2.3.</span> <span class="toc-text">1.2.3、临时属性在IDEA中设置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%9B%9B%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">3.</span> <span class="toc-text">二、配置文件的四级分类</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%BC%80%E5%8F%91"><span class="toc-number">4.</span> <span class="toc-text">三、多环境开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1%E3%80%81%E5%A4%9A%E7%8E%AF%E5%A2%83%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-1-%EF%BC%9A"><span class="toc-number">4.1.</span> <span class="toc-text">3.1、多环境注意事项(1)：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%E3%80%81%E5%A4%9A%E7%8E%AF%E5%A2%83%E7%9A%84%E7%8B%AC%E7%AB%8B%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B9%A6%E5%86%99%E6%8A%80%E5%B7%A7"><span class="toc-number">4.2.</span> <span class="toc-text">3.2、多环境的独立配置文件书写技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3%E3%80%81%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2"><span class="toc-number">4.3.</span> <span class="toc-text">3.3、多环境配置的注意事项(2):</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4%E3%80%81%E6%97%A5%E5%BF%97"><span class="toc-number">4.4.</span> <span class="toc-text">3.4、日志</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1%E3%80%81%E6%97%A5%E5%BF%97%E5%9F%BA%E7%A1%80"><span class="toc-number">4.4.1.</span> <span class="toc-text">3.4.1、日志基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2%E3%80%81%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">4.4.2.</span> <span class="toc-text">3.4.2、日志输出格式控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3%E3%80%81%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">4.4.3.</span> <span class="toc-text">3.4.3、日志文件</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">DaiHaojun</div><div class="author-info__description text-center">记录学习日常</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">25</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">36</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">myblog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">springboot运维篇</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-04-27</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="SpringBoot运维篇"><a href="#SpringBoot运维篇" class="headerlink" title="SpringBoot运维篇"></a>SpringBoot运维篇</h1><h1 id="一、springboot项目的打包"><a href="#一、springboot项目的打包" class="headerlink" title="一、springboot项目的打包"></a>一、springboot项目的打包</h1><h2 id="1-1、Window版："><a href="#1-1、Window版：" class="headerlink" title="1.1、Window版："></a>1.1、Window版：</h2><p>打包的方式：</p>
<p>jar,war</p>
<p>1、打包:spring-boot-maven-plugin 这个插件就是专门用来打包的</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.dhj.ssmp.Application<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427151705586.png" alt="image-20220427151705586"></p>
<p>点一下这个package这个就会再target里生成一个jar包</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427151932926.png" alt="image-20220427151932926"></p>
<p>执行这个的时候会进行测试，可以自行取消掉测试</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427152049555.png" alt="image-20220427152049555"></p>
<p>这个时候在打包，就不会执行测试了</p>
<p>注意打包出来后一定要看看jar包里的文件配置</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427152936672.png" alt="image-20220427152936672"></p>
<p>点开</p>
<p><strong><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427152956595.png" alt="image-20220427152956595"></strong></p>
<p>查看这个配置文件：</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427153017785.png" alt="image-20220427153017785"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427153056574.png" alt="image-20220427153056574"></p>
<p>看这里面的Start-Class的值是不是为你的java代码的主程序的类名</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427153207480.png" alt="image-20220427153207480"></p>
<p>不是的话改一下，是的话就不用管</p>
<p>这样在控制台就可以，java -jar XXX.jar </p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427153332244.png" alt="image-20220427153332244"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427151338520.png" alt="image-20220427151338520"></p>
<ul>
<li>#查询端口</li>
</ul>
<p>​		netstat -ano</p>
<ul>
<li><p>#查询指定端口<br>netstat -ano |findstr“端口号”</p>
</li>
<li><p>#根据进程PID查询进程名称<br>tasklist |findstr”进程PID号”</p>
</li>
<li><p>#根据PID杀死任务<br>taskkill &#x2F;F&#x2F;PID”进程PID号”</p>
</li>
<li><p>#根据进程名称杀死任务<br>taskkill -f -t -im”进程名称”</p>
</li>
</ul>
<h2 id="1-2、linux版："><a href="#1-2、linux版：" class="headerlink" title="1.2、linux版："></a>1.2、linux版：</h2><p>在linux中创建好环境</p>
<ul>
<li>java jdk1.8</li>
<li>mysql或者是mariadb</li>
</ul>
<p>然后将配置文件改一下:你的linux的ip地址和数据库的名字将打好的jar包上传到服务器</p>
<p>记得改一下yml的配置文件:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">        <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.59.100:3306/springboot?useSSL=false&amp;characterEncoding=utf-8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">        <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">81</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">table-prefix:</span> <span class="string">tb_</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427161347732.png" alt="image-20220427161347732"></p>
<p>同样的java -jar XXX.jar 然后就可以运行了</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427161500963.png" alt="image-20220427161500963"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427161534749.png" alt="image-20220427161534749"></p>
<p>功能都ok!</p>
<h3 id="1-2-1、后台启动的命令"><a href="#1-2-1、后台启动的命令" class="headerlink" title="1.2.1、后台启动的命令"></a>1.2.1、后台启动的命令</h3><p>nohup java -jar XXX.jar &gt;server.log 2&gt;&amp;1 &amp;</p>
<p>查询后台的进程:</p>
<p>ps -ef|grep “java -jar”</p>
<p>结束进程：</p>
<p>kill -9 pid</p>
<h3 id="1-2-2、临时的属性"><a href="#1-2-2、临时的属性" class="headerlink" title="1.2.2、临时的属性"></a>1.2.2、临时的属性</h3><p>1．使用jar命令启动SpringBoot工程时可以使用临时属性替换配置文件中的属性<br>2．临时属性添加方式:java -jar工程名.jar –属性名&#x3D;值<br>3．多个临时属性之间使用空格分隔<br>4．临时属性必须是当前boot工程支持的属性，否则设置无效</p>
<p>java -jar XXX.jar – server.port&#x3D;8080 – xx&#x3D;xx –</p>
<h3 id="1-2-3、临时属性在IDEA中设置"><a href="#1-2-3、临时属性在IDEA中设置" class="headerlink" title="1.2.3、临时属性在IDEA中设置"></a>1.2.3、临时属性在IDEA中设置</h3><p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427164148344.png" alt="image-20220427164148344"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427164248108.png" alt="image-20220427164248108"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427164340508.png" alt="image-20220427164340508"></p>
<p>再次运行：</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427164408417.png" alt="image-20220427164408417"></p>
<p>可以在运行的主程序中不要args参数这样就设置了不接受外界传参</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    SpringApplication.run(SSMApplication.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="二、配置文件的四级分类"><a href="#二、配置文件的四级分类" class="headerlink" title="二、配置文件的四级分类"></a>二、配置文件的四级分类</h1><p>1、在resource目录下的：application.yml文件的等级最低</p>
<p>2、在resource目录下的：创建一个config 目录再把application.yml配置文件放到config目录,这个配置文件的等级比你在resource目录下的application.yml高一级</p>
<p>3、在你jar包的同级目录下的application.yml 里面的所有配置文件都会覆盖掉你开发时所用的配置文件</p>
<p>4、在你jar包的同级目录下的config目录下的application.yml配置文件是最高的</p>
<ol>
<li><p>SpringBoot中4级配置文件<br>   1级: file : config&#x2F; application.yml【最高】<br> 2级: file : application.yml<br> 3级: classpath: config&#x2F;application.yml<br> 4级: classpath: application.yml【最低】</p>
</li>
<li><p>作用:</p>
<ul>
<li>1级与2级留做系统打包后设置通用属性，1级常用于运维经理进行线上整体项目部署方案调控</li>
<li>3级与4级用于系统开发阶段设置通用属性，3级常用于项目经理进行整体项目属性调控</li>
</ul>
</li>
</ol>
<p>使用–spring.config.name&#x3D;文件名。可以让配置文件不再叫application.yml也能生效</p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427171033676.png" alt="image-20220427171033676"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427171054117.png" alt="image-20220427171054117"></p>
<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220427171116676.png" alt="image-20220427171116676"></p>
<p>也可以写：–spring.config.location&#x3D;”全路径名字”</p>
<h1 id="三、多环境开发"><a href="#三、多环境开发" class="headerlink" title="三、多环境开发"></a>三、多环境开发</h1><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">online</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">pro</span></span><br><span class="line"><span class="attr">server:</span> </span><br><span class="line">  <span class="attr">port:</span> <span class="number">81</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">82</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">config:</span></span><br><span class="line">    <span class="attr">activate:</span></span><br><span class="line">      <span class="attr">on-profile:</span> <span class="string">online</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">83</span></span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-1、多环境注意事项-1-："><a href="#3-1、多环境注意事项-1-：" class="headerlink" title="3.1、多环境注意事项(1)："></a>3.1、多环境注意事项(1)：</h2><p>1.多环境开发需要设置若干种常用环境，例如开发、生产、测试环境</p>
<p>2.yaml(yml)格式中设置多环境使用”—“区分环境设置边界</p>
<p>3.每种环境的区别在于加载的配置属性不同</p>
<p>4.启用某种环境时需要指定启动时使用该环境</p>
<h2 id="3-2、多环境的独立配置文件书写技巧"><a href="#3-2、多环境的独立配置文件书写技巧" class="headerlink" title="3.2、多环境的独立配置文件书写技巧"></a>3.2、多环境的独立配置文件书写技巧</h2><p>根据功能对配置文件中的信息进行拆分，并制作成独立的配置文件，</p>
<p>命名规则如下：</p>
<ul>
<li><p>application-devDB.yml</p>
</li>
<li><p>application-devRedis.yml </p>
</li>
<li><p>application-devMVC.yml</p>
</li>
</ul>
<p>使用include属性在激活指定环境的情况下，同时对多个环境进行加载使其生效，多个环境间使用逗号分隔</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">profiles:</span></span><br><span class="line">		<span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">		<span class="attr">include:</span> <span class="string">devDB,devRedis,devMVC</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">profiles:</span></span><br><span class="line">		<span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">		<span class="attr">group:</span></span><br><span class="line">			<span class="string">&quot;dev&quot;</span> <span class="string">:</span> <span class="string">devDB,</span> <span class="string">devRedis</span> <span class="string">,</span> <span class="string">devMVC</span></span><br><span class="line">			<span class="string">&quot;pro&quot;</span> <span class="string">:</span> <span class="string">proDB</span> <span class="string">,</span> <span class="string">proRedis</span> <span class="string">,proMVC</span></span><br><span class="line">			<span class="attr">&quot;test&quot;:</span> <span class="string">testDB,testRedis,testMVC</span></span><br></pre></td></tr></table></figure>



<h2 id="3-3、多环境配置的注意事项-2"><a href="#3-3、多环境配置的注意事项-2" class="headerlink" title="3.3、多环境配置的注意事项(2):"></a>3.3、多环境配置的注意事项(2):</h2><p>1．当Maven与SpringBoot同时对多环境进行控制时，以Mavn为主，SpringBoot使用@..@占位符读取Maven对应的配置属性值</p>
<p>2．基于SpringBoot读取Maven配置属性的前提下，如果在Idea下测试工程时pom. xml每次更新需要手动compile方可生效</p>
<h2 id="3-4、日志"><a href="#3-4、日志" class="headerlink" title="3.4、日志"></a>3.4、日志</h2><h3 id="3-4-1、日志基础"><a href="#3-4-1、日志基础" class="headerlink" title="3.4.1、日志基础"></a>3.4.1、日志基础</h3><p>日志（ log）作用：</p>
<ul>
<li>编程期调试代码运营期记录信息</li>
<li>记录运维过程数据(扩容、宕机、报警……)</li>
<li>记录日常运营重要信息（峰值流量、平均响应时长……)记录应用报错信息（错误堆栈)</li>
</ul>
<p>日志级别：</p>
<ul>
<li><p>TRACE:运行堆栈信息，使用率低</p>
</li>
<li><p>DEBUG:程序员调试代码使用</p>
</li>
<li><p>INFO:记录运维过程数据</p>
</li>
<li><p>WARN:记录运维过程报警数据</p>
</li>
<li><p>ERROR∶记录错误堆栈信息</p>
</li>
<li><p>FATAL:灾难信息，合并计入ERROR</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line"><span class="comment">//创建记录日志的对象</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(BookController.class);</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Hello</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;info...&quot;</span>);</span><br><span class="line">        log.error(<span class="string">&quot;error...&quot;</span>);</span><br><span class="line">        log.debug(<span class="string">&quot;debug...&quot;</span>); </span><br><span class="line">        log.trace(<span class="string">&quot;trace...&quot;</span>); <span class="comment">//堆栈信息，级别太低没人用</span></span><br><span class="line">        log.warn(<span class="string">&quot;warn...&quot;</span>);    </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>建议这样配置：</p>
<p>在yml文件中写</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="comment">#设置分组</span></span><br><span class="line">  <span class="attr">group:</span></span><br><span class="line">    <span class="attr">dhj:</span> <span class="string">com.dhj.controller,com.dhj.service,com.dhj.dao,com.dhj.pojo</span></span><br><span class="line">    <span class="attr">alibaba:</span> <span class="string">com.alibaba</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">  <span class="comment"># 设置日志的级别</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">debug</span></span><br><span class="line">    <span class="attr">dhj:</span> <span class="string">info</span></span><br><span class="line">    <span class="attr">ailibaba:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>

<p>在类上加上<code>@Slf4j</code>注解可以快速添加日志对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/books&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;info...&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-2、日志输出格式控制"><a href="#3-4-2、日志输出格式控制" class="headerlink" title="3.4.2、日志输出格式控制"></a>3.4.2、日志输出格式控制</h3><p>在yml中配置</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">pattern:</span></span><br><span class="line">    <span class="comment">#时间-(clr:颜色) - (%5p)五个字符的日志级别---[%10t]十个字符的线程名 带颜色的40个字符的类名：消息，换行</span></span><br><span class="line">    <span class="attr">console:</span> <span class="string">&quot;%d-%clr(%5p)---[%10t] %clr(%-40.40c)&#123;cyan&#125; : %msg:%n&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-3、日志文件"><a href="#3-4-3、日志文件" class="headerlink" title="3.4.3、日志文件"></a>3.4.3、日志文件</h3><p>直接在配置文件里配置：</p>
<p><strong><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220428203325426.png" alt="image-20220428203325426"></strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">pattern:</span></span><br><span class="line">    <span class="comment">#时间-消息</span></span><br><span class="line">    <span class="attr">console:</span> <span class="string">&quot;%d-%clr(%5p)---[%10t] %clr(%-40.40c)&#123;cyan&#125; : %msg:%n&quot;</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">server.log</span></span><br><span class="line">    <span class="comment">#日志的名字</span></span><br><span class="line">    <span class="attr">max-size:</span> <span class="string">4KB</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220428203430129.png" alt="image-20220428203430129"></p>
<table>
<thead>
<tr>
<th>日志输出格式：<br>	%d 表示日期时间，<br>	%thread 表示线程名，<br>	%-5level:级别从左显示5个字符宽度<br>	%logger{50}  表示logger名字最长50个字符，否则按照句点分割。 <br>	%msg: 日志消息，<br>	%n 是换行符<br>   –&gt;<br>   %d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n</th>
</tr>
</thead>
</table>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">server.log</span></span><br><span class="line">    <span class="comment">#时间-消息</span></span><br><span class="line">      <span class="attr">max-size:</span> <span class="string">3KB</span></span><br><span class="line">  <span class="attr">pattern:</span></span><br><span class="line">    <span class="attr">console:</span> <span class="string">&quot;%d-%clr(%5p)---[%10t] %clr(%-40.40c)&#123;cyan&#125; : %msg:%n&quot;</span></span><br><span class="line">    <span class="comment">#设置滚动的日志记录</span></span><br><span class="line">    <span class="comment">#当文件日志达到一定大小的时候就会重新创建一个文件存放日志</span></span><br><span class="line">    <span class="attr">rolling-file-name:</span> <span class="string">server.%d.%i.log</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/27/springboot%E8%BF%90%E7%BB%B4%E7%AF%87/image-20220428214340376.png" alt="image-20220428214340376"></p>
<p>运维篇告一段落;但是没完！</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">DaiHaojun</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://daihaojun554.github.io/2022/04/27/springboot运维篇/">http://daihaojun554.github.io/2022/04/27/springboot运维篇/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/springboot/">springboot</a><a class="post-meta__tags" href="/tags/%E8%BF%90%E7%BB%B4/">运维</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2022/04/29/SpringBoot%E5%BC%80%E5%8F%91%E5%AE%9E%E7%94%A8%E7%AF%87/"><i class="fa fa-chevron-left">  </i><span>SpringBoot开发实用篇</span></a></div><div class="next-post pull-right"><a href="/2022/04/25/vue%E5%88%9D%E8%AF%86/"><span>vue初识</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By DaiHaojun</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://daihaojun.top">blog</a>!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://lib.baomitu.com/animejs/latest/anime.min.js"></script><script src="https://lib.baomitu.com/jquery/latest/jquery.min.js"></script><script src="https://lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script src="https://lib.baomitu.com/velocity/latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>